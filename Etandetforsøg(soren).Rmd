---
title: "noget andet"
author: "Søren D. NIelsen"
date: "9 maj 2019"
output: html_document
---

```{r setup, include=FALSE}
library(RandomFields)
library(kriging)
library(sp)
library(gstat)
library(dplyr)
library(ggplot2)
library(scales)
library(magrittr)
library(spatstat)
library(colorspace)
library(RColorBrewer)
library(mvtnorm)
library(raster)
library(tcltk2)
library(tkrplot)
library(spam)
library(tools)
library(geoR)
library(minqa)
library(soma)
library(optimx)
library(nloptr)
library(pso)
library(GenSA)
```

```{r}
RFoptions(seed=0, height=4) ## *ANY* simulation will have the random seed 0; set
##                   RFoptions(seed=NA) to make them all random again




RFoptions(modus_operandi="sloppy")
```


```{r}
points <- 100
x <- runif(points, 0, 3)
y <- runif(points, 0, 3) ## random points in square [0, 3]^2
model <- RMgencauchy(alpha=1, beta=2)
d <- RFsimulate(model, x=x, y=y, grid=FALSE, n=1) #1000
```

```{r}
dev.new(height=50, width=50)
p <- 1:25
points <- as.matrix(expand.grid(p,p))
model45 <- RMexp() + RMtrend(mean=1)
dta <- RFsimulate(model45, x=points)
plot(dta)
x <- seq(0, 25, 0.25)

```

ordinær kriging
```{r}
model <- RMexp() + RMtrend(mean=NA)
z <- RFinterpolate(model, x=x, y=x, data=dta)
plot(z, dta)
```


```{r}
#estmodel <- RMgencauchy(var=NA, scale=NA, alpha=NA, beta=2) +
            RMtrend(mean=NA)
#gh <- RFfit(estmodel, data=d)
```




```{r}
#A=as.data.frame(cbind(Aalborg$Kontantpris,Aalborg$xkoor,Aalborg$ykoor))
#Asub <- A[sample(1000,size = 50),]
#coordinates(Asub) <- ~V2+V3
#Asub <- sp2RF(Asub, param = list(n=1, vdim=1))
#A2sub <- 
```

```{r}
data("weather")
```

```{r}
dist.mat <- as.vector(RFearth2cartesian(weather[,3:4]))
```

```{r}
nug <- RMmatrix(M = matrix(nc = 2, c(NA, 0, 0, NA)), RMnugget())
pars.model <- nug + RMbiwm(nudiag = c(NA, NA), scale = NA, cdiag = c(NA, NA), rhored = NA)

```



```{r}
P <- weather[,1:2]
model <- RMgauss()
Pmodel <- RFfit(model = pars.model, distances = dist.mat, dim = 3, data = P)
```


```{r}
a <- colMeans(weather[, 3:4]) * pi / 180
P <- cbind(c(-sin(a[1]), cos(a[1]), 0), c(-cos(a[1]) * sin(a[2]), -sin(a[1]) * sin(a[2]), cos(a[2])), c(cos(a[1]) * cos(a[2]), sin(a[1]) * cos(a[2]), sin(a[2])))
x <- RFearth2cartesian(weather[, 3:4])
plane <- (x %*% P)[, 1:2]

```

```{r}
n <- 200
r <- apply(plane, 2, range)
data <- cbind(plane, weather[, 1:2])
z <- RFinterpolate(RMgauss()+RMtrend(mean = NA), data = data, dim = 2, x = seq(r[1, 1], r[2, 1], length = n), y = seq(r[1, 2], r[2, 2], length = n), varunits = c("Pa", "K"))
plot(z)

```






































